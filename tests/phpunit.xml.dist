<?xml version="1.0" encoding="UTF-8"?>
<phpunit
  bootstrap="phpunit.bootstrap.php"
  cacheResult="false"
  colors="true"
  stopOnFailure="false"
  failOnWarning="true"
  failOnRisky="true"
  beStrictAboutOutputDuringTests="true"
  failOnDeprecation="true"
  failOnPhpunitDeprecation="true"
  displayDetailsOnTestsThatTriggerDeprecations="true"
  displayDetailsOnSkippedTests="true"
>
  <testsuites>
    <testsuite name="DB Integration">
      <directory>Integration</directory>
      <directory>Contract</directory>
      <directory>Performance</directory>
      <directory>Consistency</directory>
      <directory>Unit</directory>
      <directory>Concurrency</directory>
      <directory>Umbrella</directory>
    </testsuite>
  </testsuites>
  <php>
    <!-- defaults can be overridden via env vars in CI / locally -->
    <env name="MYSQL_DSN"  value="mysql:host=127.0.0.1;port=3306;dbname=test;charset=utf8mb4"/>
    <env name="MYSQL_USER" value="root"/>
    <env name="MYSQL_PASS" value="root"/>

    <env name="PG_DSN"  value="pgsql:host=127.0.0.1;port=5432;dbname=test"/>
    <env name="PG_USER" value="postgres"/>
    <env name="PG_PASS" value="postgres"/>

    <!-- install feature views during tests -->
    <env name="BC_INCLUDE_FEATURE_VIEWS" value="1"/>

    <!-- enable for heavier tests (bulk 10k, etc.) -->
    <env name="BC_STRESS" value="0"/>
  </php>
  <coverage>
    <report>
      <clover outputFile="tmp/coverage/clover.xml"/>
    </report>
  </coverage>
  <source>
    <include>
      <directory suffix=".php">../src</directory>
      <directory suffix=".php">../packages</directory>
    </include>
  </source>
</phpunit>
