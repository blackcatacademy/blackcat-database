
apiVersion: v1
kind: ConfigMap
metadata:
  name: grafana-datasources-bench
  namespace: monitoring
data:
  datasources.yaml: |
    apiVersion: 1
    datasources:
      - name: Loki
        type: loki
        access: proxy
        url: http://loki-stack:3100
        isDefault: true
      - name: Elasticsearch
        type: elasticsearch
        access: proxy
        url: http://elasticsearch-master:9200
        jsonData:
          index: bench-logs
          timeField: ts_iso
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: grafana-dashboards-bench
  namespace: monitoring
  labels:
    grafana_dashboard: "1"
data:
  bench.json: |
    {
      "dashboard": {
        "uid": "blackcat-bench",
        "title": "BlackCat Bench \u2013 Overview",
        "timezone": "browser",
        "panels": [
          {
            "type": "timeseries",
            "title": "Latency (ms) \u2013 avg/p95",
            "gridPos": {
              "h": 8,
              "w": 24,
              "x": 0,
              "y": 0
            },
            "targets": [],
            "description": "Bind your Loki or ES datasource and set query to show avg/p95 of ms over time."
          },
          {
            "type": "stat",
            "title": "Error rate",
            "gridPos": {
              "h": 4,
              "w": 12,
              "x": 0,
              "y": 8
            },
            "targets": [],
            "description": "Show rate of ok==0 events per minute."
          },
          {
            "type": "stat",
            "title": "Rows/second",
            "gridPos": {
              "h": 4,
              "w": 12,
              "x": 12,
              "y": 8
            },
            "targets": [],
            "description": "Sum(rows) per second from CSV ingested logs."
          }
        ],
        "schemaVersion": 38,
        "version": 1
      },
      "overwrite": false
    }
