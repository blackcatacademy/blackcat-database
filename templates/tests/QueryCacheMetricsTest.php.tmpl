<?php
declare(strict_types=1);
use PHPUnit\Framework\TestCase;
final class {{Name}}QueryCacheMetricsTest extends TestCase {
  public function test_metrics_and_prefix_invalidation(): void {
    if (!class_exists('\\ArrayCache') && !class_exists('\\BlackCat\\Tests\\Support\\ArrayCache')) {
      $this->markTestSkipped('ArrayCache not available in this environment');
    }
    $cache = class_exists('\\BlackCat\\Tests\\Support\\ArrayCache')
      ? new \BlackCat\\Tests\\Support\\ArrayCache()
      : new \ArrayCache();
    $qc = new \QueryCache($cache); // adjust namespace if needed
    $v1 = $qc->remember('users:list', 10, fn()=>123);
    $v2 = $qc->remember('users:list', 10, fn()=>456);
    $qc->invalidatePrefix('users:');
    $v3 = $qc->remember('users:list', 10, fn()=>789);
    $this->assertSame(123, $v1);
    $this->assertSame(123, $v2);
    $this->assertSame(789, $v3);
  }
}