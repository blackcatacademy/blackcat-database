# Prometheus alerting rules for BlackCat Bench
groups:
  - name: bench-slo
    rules:
      - alert: BenchHighErrorRate
        expr: |
          (sum(rate(bench_errors_total{app="blackcat-bench"}[5m]))
            / clamp_min(sum(rate(bench_ops_total{app="blackcat-bench"}[5m])), 1)) > 0.02
        for: 10m
        labels:
          severity: warning
          team: data
        annotations:
          summary: "Bench high error rate (>2% for 10m)"
          description: "Error rate is {{ $value | printf \"%.2f\" }} for app=blackcat-bench"
      - alert: BenchHighP95Latency
        expr: |
          histogram_quantile(0.95, sum by (le) (rate(bench_latency_ms_bucket{app="blackcat-bench"}[5m]))) > 200
        for: 10m
        labels:
          severity: warning
          team: data
        annotations:
          summary: "Bench p95 latency > 200ms for 10m"
          description: "p95 latency above SLO for app=blackcat-bench"
      - alert: BenchNoTraffic
        expr: |
          sum(rate(bench_ops_total{app="blackcat-bench"}[10m])) == 0
        for: 15m
        labels:
          severity: info
          team: data
        annotations:
          summary: "Bench no traffic for 15m"
          description: "No operations observed in last 15 minutes"
